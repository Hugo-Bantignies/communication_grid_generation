<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
	<script src="http://d3js.org/d3.v6.js"></script>
  </head>

<body>
	<div id='pictogram_grid'>
		<div id='pictogram_grid'></div>
	</div>
</body>
<script>

	// set the dimensions and margins of the graph
	const margin = {top: 30, right: 30, bottom: 30, left: 30},
	  width = 450 - margin.left - margin.right,
	  height = 450 - margin.top - margin.bottom;
	
	// append the svg object to the body of the page
	const svg = d3.select("#pictogram_grid")
	.append("svg")
	  .attr("width", width + margin.left + margin.right)
	  .attr("height", height + margin.top + margin.bottom)
	.append("g")
	  .attr("transform", `translate(${margin.left},${margin.top})`);
	
	// Build X scales and axis:
	const x = d3.scaleBand()
	  .range([ 0, width ])
	  .domain(d3.range(9))
	  .padding(0.01);
	svg.append("g")
	  .attr("transform", `translate(0, ${height})`)
	  .call(d3.axisBottom(x))
	
	// Build X scales and axis:
	const y = d3.scaleBand()
	  .range([ 0 , height ])
	  .domain(d3.range(9))
	  .padding(0.01);
	svg.append("g")
	  .call(d3.axisLeft(y));
	
	//Read the data
	d3.csv("../../default.csv", d => (
	{
		word:     d.word,
		row:     +d.row,
		col:    +d.col,
		page: d.page,
		identifier: d.identifier,
	}
	)).then(function(data) {
	
	  // create a tooltip
	  const tooltip = d3.select("#pictogram_grid")
		.append("div")
		.style("opacity", 0)
		.attr("class", "tooltip")
		.style("background-color", "white")
		.style("border", "solid")
		.style("border-width", "2px")
		.style("border-radius", "5px")
		.style("padding", "5px")
	
	  // Three function that change the tooltip when user hover / move / leave a cell
	  const mouseover = function(event,d) {
		tooltip.style("opacity", 1)
	  }
	  const mousemove = function(event,d) {
		tooltip
		  .html("Word : " + d.word)
		  .style("left", (event.x)/2 + "px")
		  .style("top", (event.y)/2 + "px")
	  }
	  const mouseleave = function(d) {
		tooltip.style("opacity", 0)
	  }
	
	  // add the squares
	  svg.selectAll()
		.data(data)
		.enter()
		.append("rect")
		  .attr("x", function(d) { return x(d.col) })
		  .attr("y", function(d) { return y(d.row) })
		  .attr("width", x.bandwidth() )
		  .attr("height", y.bandwidth() )
		  .style("fill", "white" )
		  .style("stroke","black")
		.on("mouseover", mouseover)
		.on("mousemove", mousemove)
		.on("mouseleave", mouseleave)

	  svg.selectAll()
		.data(data)
		.enter()
	  	.append("text")
		  .attr("dy", ".3em")
	  	  .attr("x", function(d) { return x(d.col) })
		  .attr("y", function(d) { return y(d.row) })
		  .text(function(d) { return d.word; });
	})
	</script>
</html>